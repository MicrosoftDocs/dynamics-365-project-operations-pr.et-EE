---
title: Arve automaatse loomise häälestamine
description: See teema sisaldab teavet näidisarvete automaatse loomise häälestamise ja konfigureerimise kohta.
author: rumant
ms.date: 04/05/2021
ms.topic: article
ms.reviewer: kfend
ms.author: rumant
ms.openlocfilehash: 2d212f2279b28d900e75d45386e343f95b8e825e
ms.sourcegitcommit: 40f68387f594180af64a5e5c748b6efa188bd300
ms.translationtype: HT
ms.contentlocale: et-EE
ms.lasthandoff: 05/10/2021
ms.locfileid: "6004166"
---
# <a name="set-up-automatic-invoice-creation"></a><span data-ttu-id="e3819-103">Arve automaatse loomise häälestamine</span><span class="sxs-lookup"><span data-stu-id="e3819-103">Set up automatic invoice creation</span></span> 
 
<span data-ttu-id="e3819-104">_**Kehtib järgmistele:** lihtjuurutamine – tehing näidisarveldusele, Project Operations ressursipõhiste/mittelaopõhiste stsenaariumite jaoks_</span><span class="sxs-lookup"><span data-stu-id="e3819-104">_**Applies To:** Lite deployment - deal to proforma invoicing, Project Operations for resource/non-stocked based scenarios_</span></span>

<span data-ttu-id="e3819-105">Automaatse arve loomise saate konfigureerida rakenduses Dynamics 365 Project Operations.</span><span class="sxs-lookup"><span data-stu-id="e3819-105">You can configure automatic invoice creation in Dynamics 365 Project Operations.</span></span> <span data-ttu-id="e3819-106">Süsteem loob iga projekti lepingu ja lepingurea jaoks arve ajakaval põhineva näidisarve mustandi.</span><span class="sxs-lookup"><span data-stu-id="e3819-106">The system creates a draft proforma invoice based on the invoice schedule for each project contract and contract line.</span></span> <span data-ttu-id="e3819-107">Arve ajakavad konfigureeritakse lepingurea tasemel.</span><span class="sxs-lookup"><span data-stu-id="e3819-107">Invoice schedules are configured at the contract line level.</span></span> <span data-ttu-id="e3819-108">Igal lepingureal võib olla eraldi arve ajakava või saab igale lepingureale kaasata sama arve ajakava.</span><span class="sxs-lookup"><span data-stu-id="e3819-108">Each line on a contract can have a distinct invoice schedule, or the same invoice schedule can be included on every line of the contract.</span></span>

<span data-ttu-id="e3819-109">Arve loomisel loob süsteem alati projekti lepingu kohta vähemalt ühe arve.</span><span class="sxs-lookup"><span data-stu-id="e3819-109">When you create an invoice, the system always creates at least one invoice per project contract.</span></span> <span data-ttu-id="e3819-110">Mõnel juhul luuakse mitu arvet.</span><span class="sxs-lookup"><span data-stu-id="e3819-110">In some cases, there may be multiple invoices created.</span></span> <span data-ttu-id="e3819-111">Näiteks kui lepingul on mitu klienti, luuakse sama arv arveid kui on kliente, kellel on selle projekti lepingu kohta arveldatavaid tehingud.</span><span class="sxs-lookup"><span data-stu-id="e3819-111">For example, if the contract has multiple customers, the same number of invoices will be created as the number of customers that have billable transactions to invoice on that project contract.</span></span>

## <a name="understand-how-transactions-are-included-on-an-invoice"></a><span data-ttu-id="e3819-112">Tehingute arvesse kaasamise mõistmine</span><span class="sxs-lookup"><span data-stu-id="e3819-112">Understand how transactions are included on an invoice</span></span> 

<span data-ttu-id="e3819-113">Mõnikord määratleb iga projektil põhinev lepingurida eraldi arve ajakava.</span><span class="sxs-lookup"><span data-stu-id="e3819-113">Sometimes, each project-based contract line specifies a separate invoice schedule.</span></span> <span data-ttu-id="e3819-114">Näiteks Adatum lepingu rakendamisel on järgmised lepinguread.</span><span class="sxs-lookup"><span data-stu-id="e3819-114">For example, implementation services for the Adatum contract have the following contract lines:</span></span>

- <span data-ttu-id="e3819-115">Prototüüp, mis on fikseeritud hinnaga koos kahe käsitsi loodud vahe-eesmärgiga.</span><span class="sxs-lookup"><span data-stu-id="e3819-115">Prototype work that is a fixed price with two manually created milestones.</span></span>
- <span data-ttu-id="e3819-116">Rakendamise töö, mis sisaldab aega ja arveldatakse kahe nädala tagant esmaspäeviti.</span><span class="sxs-lookup"><span data-stu-id="e3819-116">Implementation work that includes Time and will be billed bi-weekly on Mondays.</span></span>
- <span data-ttu-id="e3819-117">Kulud, mille eest tuleb arved esitada iga kuu esimesel esmaspäeval.</span><span class="sxs-lookup"><span data-stu-id="e3819-117">Expenses incurred that need to be billed monthly on the first Monday of each month.</span></span>

<span data-ttu-id="e3819-118">Mõlemal kahel real määratletud arvete ajakavad näevad välja nagu järgmine tabel.</span><span class="sxs-lookup"><span data-stu-id="e3819-118">Invoice schedules defined on each of these two line items look like the following table:</span></span>

| <span data-ttu-id="e3819-119">Lepingurida</span><span class="sxs-lookup"><span data-stu-id="e3819-119">Contract line</span></span> | <span data-ttu-id="e3819-120">Arve tsükli kuupäev</span><span class="sxs-lookup"><span data-stu-id="e3819-120">Invoice run date</span></span> | <span data-ttu-id="e3819-121">Kande katkestamise kuupäev</span><span class="sxs-lookup"><span data-stu-id="e3819-121">Transaction cut-off date</span></span> | <span data-ttu-id="e3819-122">Vahe-eesmärgi kuupäev</span><span class="sxs-lookup"><span data-stu-id="e3819-122">Milestone date</span></span> | <span data-ttu-id="e3819-123">Vahe-eesmärgi summa</span><span class="sxs-lookup"><span data-stu-id="e3819-123">Milestone amount</span></span> |
| --- | --- | --- | --- | --- |
| <span data-ttu-id="e3819-124">Prototüüp</span><span class="sxs-lookup"><span data-stu-id="e3819-124">Prototype work</span></span> | <span data-ttu-id="e3819-125">Esmaspäev, 5. oktoober</span><span class="sxs-lookup"><span data-stu-id="e3819-125">October 5, Monday</span></span> | - | <span data-ttu-id="e3819-126">Esmaspäev, 5. oktoober</span><span class="sxs-lookup"><span data-stu-id="e3819-126">October 5, Monday</span></span> | <span data-ttu-id="e3819-127">5000 USD</span><span class="sxs-lookup"><span data-stu-id="e3819-127">5000 USD</span></span> |
| - | <span data-ttu-id="e3819-128">Teisipäev, 3. november</span><span class="sxs-lookup"><span data-stu-id="e3819-128">November 3, Tuesday</span></span> | - | <span data-ttu-id="e3819-129">Teisipäev, 3. november</span><span class="sxs-lookup"><span data-stu-id="e3819-129">November 3, Tuesday</span></span> | <span data-ttu-id="e3819-130">12,000 USD</span><span class="sxs-lookup"><span data-stu-id="e3819-130">12,000 USD</span></span> |
| <span data-ttu-id="e3819-131">Töö rakendamine</span><span class="sxs-lookup"><span data-stu-id="e3819-131">Implementation work</span></span> | <span data-ttu-id="e3819-132">Esmaspäev, 5. oktoober</span><span class="sxs-lookup"><span data-stu-id="e3819-132">October 5, Monday</span></span> | <span data-ttu-id="e3819-133">Pühapäev, 4. oktoober</span><span class="sxs-lookup"><span data-stu-id="e3819-133">October 4, Sunday</span></span> | - | - |
| - | <span data-ttu-id="e3819-134">Esmaspäev, 19. oktoober</span><span class="sxs-lookup"><span data-stu-id="e3819-134">October 19, Monday</span></span> | <span data-ttu-id="e3819-135">Pühapäev, 18. oktoober</span><span class="sxs-lookup"><span data-stu-id="e3819-135">October 18, Sunday</span></span> | - | - |
| - | <span data-ttu-id="e3819-136">Esmaspäev, 2. november</span><span class="sxs-lookup"><span data-stu-id="e3819-136">November 2, Monday</span></span> | <span data-ttu-id="e3819-137">Pühapäev, 1. november</span><span class="sxs-lookup"><span data-stu-id="e3819-137">November 1, Sunday</span></span> | - | - |
| - | <span data-ttu-id="e3819-138">Esmaspäev, 16. november</span><span class="sxs-lookup"><span data-stu-id="e3819-138">November 16, Monday</span></span> | <span data-ttu-id="e3819-139">Pühapäev, 15. november</span><span class="sxs-lookup"><span data-stu-id="e3819-139">November 15, Sunday</span></span> | - | - |
| <span data-ttu-id="e3819-140">Tekkinud kulud</span><span class="sxs-lookup"><span data-stu-id="e3819-140">Expenses incurred</span></span> | <span data-ttu-id="e3819-141">Esmaspäev, 5. oktoober</span><span class="sxs-lookup"><span data-stu-id="e3819-141">October 5, Monday</span></span> | <span data-ttu-id="e3819-142">Pühapäev, 4. oktoober</span><span class="sxs-lookup"><span data-stu-id="e3819-142">October 4, Sunday</span></span> | - | - |
| - | <span data-ttu-id="e3819-143">Esmaspäev, 2. november</span><span class="sxs-lookup"><span data-stu-id="e3819-143">November 2, Monday</span></span> | <span data-ttu-id="e3819-144">Pühapäev, 1. november</span><span class="sxs-lookup"><span data-stu-id="e3819-144">November 1, Sunday</span></span> | - | - |

<span data-ttu-id="e3819-145">Selles näites käivitub automaatne arveldamine järgmiselt.</span><span class="sxs-lookup"><span data-stu-id="e3819-145">In this example when the automatic invoicing runs on:</span></span>

- <span data-ttu-id="e3819-146">**4. oktoober või mis tahes päev enne seda**: selle lepingu jaoks ei looda arvet, kuna iga sellise lepingurea tabel **Arve ajakava** ei sea arve rakendamise kuupäevaks pühapäeva, 4. oktoobrit.</span><span class="sxs-lookup"><span data-stu-id="e3819-146">**October 4 or any date before**: No invoice is generated for this contract because the **Invoice Schedule** table for each of these contract lines doesn't call out October 4, Sunday as an invoice run date.</span></span>
- <span data-ttu-id="e3819-147">**Esmaspäev, 5. oktoober**: üks arve luuakse järgmise jaoks.</span><span class="sxs-lookup"><span data-stu-id="e3819-147">**October 5 Monday**: One invoice is generated for:</span></span>

    - <span data-ttu-id="e3819-148">Prototüüp, mis sisaldab vahe-eesmärki, kui see on märgitud kui **Arveldamiseks valmis**.</span><span class="sxs-lookup"><span data-stu-id="e3819-148">Prototype work that includes the milestone, if it is marked as **Ready to Invoice**.</span></span>
    - <span data-ttu-id="e3819-149">Rakendamise töö, mis hõlmab kõiki ajatehinguid, mis on loodud enne tehingu katkestamise kuupäeva pühapäeval, 4. oktoobril, mis on märgitud kui **Arveldamiseks valmis**.</span><span class="sxs-lookup"><span data-stu-id="e3819-149">Implementation work that includes all Time transactions created before the transaction cut-off date of October 4, Sunday, that is marked as **Ready to Invoice**.</span></span>
    - <span data-ttu-id="e3819-150">Tekkinud kulud, mis hõlmavad kõiki kulutehinguid, mis on loodud enne tehingu katkestamise kuupäeva pühapäeval, 4. oktoobril, mis on märgitud kui **Arveldamiseks valmis**.</span><span class="sxs-lookup"><span data-stu-id="e3819-150">Expense incurred that includes all Expense transactions created before the transaction cut-off date of October 4, Sunday, that is marked as **Ready to Invoice**.</span></span>
  
- <span data-ttu-id="e3819-151">**6. oktoober või mis tahes päev enne 19. oktoobrit**: selle lepingu jaoks ei looda arvet, kuna iga sellise lepingurea tabel **Arve ajakava** ei sea arve rakendamise kuupäevaks pühapäeva, 6. oktoobrit või mis tahes päeva enne 19. oktoobrit.</span><span class="sxs-lookup"><span data-stu-id="e3819-151">**On October 6 or any date before October 19**: No invoice is generated for this contract since the **Invoice Schedule** table for each of these contract lines does not call out October 6 or any date before October 19 as an invoice run date.</span></span>
- <span data-ttu-id="e3819-152">**Esmaspäev, 19. oktoober**: luuakse üks arve rakendamise töö jaoks, mis hõlmab kõiki ajatehinguid, mis on loodud enne tehingu katkestamise kuupäeva pühapäeval, 18. oktoobril, mis on märgitud kui **Arveldamiseks valmis**.</span><span class="sxs-lookup"><span data-stu-id="e3819-152">**October 19, Monday**: One invoice is generated for implementation work that includes all Time transactions created before the transaction cut-off date of October 18, Sunday, that is marked as **Ready to Invoice**.</span></span>
- <span data-ttu-id="e3819-153">**Esmaspäev, 2. november**: üks arve luuakse järgmise jaoks.</span><span class="sxs-lookup"><span data-stu-id="e3819-153">**November 2 Monday**: One invoice is generated for:</span></span>

    - <span data-ttu-id="e3819-154">Rakendamise töö, mis hõlmab kõiki ajatehinguid, mis on loodud enne tehingu katkestamise kuupäeva pühapäeval, 1. novembril, mis on märgitud kui **Arveldamiseks valmis**.</span><span class="sxs-lookup"><span data-stu-id="e3819-154">Implementation work that includes all Time transactions created before the transaction cut-off date of November 1, Sunday, that is marked as **Ready to Invoice**.</span></span>
    - <span data-ttu-id="e3819-155">Tekkinud kulud, mis hõlmavad kõiki kulutehinguid, mis on loodud enne tehingu katkestamise kuupäeva pühapäeval, 1. novembril, mis on märgitud kui **Arveldamiseks valmis**.</span><span class="sxs-lookup"><span data-stu-id="e3819-155">Expense incurred that includes all Expense transactions created before the transaction cut-off date of November 1, Sunday, that is marked as **Ready to Invoice**.</span></span>

- <span data-ttu-id="e3819-156">**Teisipäev, 3. november**: üks arve luuakse prototüübi jaoks, mille vahe-eesmärk sisaldab 12 000 USA dollarit, kui see on märgitud kui **Arveldamiseks valmis**.</span><span class="sxs-lookup"><span data-stu-id="e3819-156">**November 3, Tuesday**: One invoice is generated for prototype work that includes the milestone for 12000 USD, if it is marked as **Ready to Invoice**.</span></span>

## <a name="configure-automatic-invoicing"></a><span data-ttu-id="e3819-157">Automaatse arveldamise konfigureerimine</span><span class="sxs-lookup"><span data-stu-id="e3819-157">Configure automatic invoicing</span></span>

<span data-ttu-id="e3819-158">Toimige järgmiselt, et konfigureerida automatiseeritud arve.</span><span class="sxs-lookup"><span data-stu-id="e3819-158">Complete the following steps to configure an automated invoice run.</span></span>

1. <span data-ttu-id="e3819-159">Avage rakendus **Project Operations**, minge jaotisesse **Sätted** > **Korduva arve seadistamine**.</span><span class="sxs-lookup"><span data-stu-id="e3819-159">In **Project Operations**, go to **Settings** > **Recurring Invoice Setup**.</span></span>
2. <span data-ttu-id="e3819-160">Looge pakett-töö ja pange sellele nimeks **Project Operationsi arvete loomine**.</span><span class="sxs-lookup"><span data-stu-id="e3819-160">Create a batch job, and name it **rPoject Operations Create Invoices**.</span></span> <span data-ttu-id="e3819-161">Pakett-töö nimi peab sisaldama sõnu „arvete loomine”.</span><span class="sxs-lookup"><span data-stu-id="e3819-161">The name of the batch job must include the words, "create invoices".</span></span>
3. <span data-ttu-id="e3819-162">Valige väljal **Töö tüüp** väärtus **Puudub**.</span><span class="sxs-lookup"><span data-stu-id="e3819-162">In the **Job Type** field, select **None**.</span></span> <span data-ttu-id="e3819-163">Vaikimisi on väljade **Sageduse päev** ja **On aktiivne** väärtuseks **Jah**.</span><span class="sxs-lookup"><span data-stu-id="e3819-163">By default, the **Frequency Daily** and **Is Active** fields are set to **Yes**.</span></span>
4. <span data-ttu-id="e3819-164">Valige **Käivita töövoog**.</span><span class="sxs-lookup"><span data-stu-id="e3819-164">Select **Run Workflow**.</span></span> <span data-ttu-id="e3819-165">Näete dialoogiboksis **Kirje otsimine** kolme töövoogu.</span><span class="sxs-lookup"><span data-stu-id="e3819-165">In the **Look Up Record** dialog box, you will see three workflows:</span></span>

- <span data-ttu-id="e3819-166">ProcessRunCaller</span><span class="sxs-lookup"><span data-stu-id="e3819-166">ProcessRunCaller</span></span>
- <span data-ttu-id="e3819-167">ProcessRunner</span><span class="sxs-lookup"><span data-stu-id="e3819-167">ProcessRunner</span></span>
- <span data-ttu-id="e3819-168">UpdateRoleUtilization</span><span class="sxs-lookup"><span data-stu-id="e3819-168">UpdateRoleUtilization</span></span>

5. <span data-ttu-id="e3819-169">Valige **ProcessRunCaller** ja seejärel **Lisa**.</span><span class="sxs-lookup"><span data-stu-id="e3819-169">Select **ProcessRunCaller**, and then select **Add**.</span></span>
6. <span data-ttu-id="e3819-170">Valige järgmises dialoogiboksis **OK**.</span><span class="sxs-lookup"><span data-stu-id="e3819-170">In the next dialog box, select **OK**.</span></span> <span data-ttu-id="e3819-171">**Unerežiimi** töövoole järgneb **protsessi** töövoog.</span><span class="sxs-lookup"><span data-stu-id="e3819-171">A **Sleep** workflow is followed by a **Process** workflow.</span></span> 

> [!NOTE]
> <span data-ttu-id="e3819-172">Etapis 5 saate valida ka töövoo **ProcessRunner**.</span><span class="sxs-lookup"><span data-stu-id="e3819-172">You can also select **ProcessRunner** in step 5.</span></span> <span data-ttu-id="e3819-173">Seejärel, kui valite **OK**, järgneb **protsessi** töövoole **unerežiimi** töövoog.</span><span class="sxs-lookup"><span data-stu-id="e3819-173">Then, when you select **OK**, a **Process** workflow is followed by a **Sleep** workflow.</span></span>

<span data-ttu-id="e3819-174">Töövood **ProcessRunCaller** ja **ProcessRunner** loovad arveid.</span><span class="sxs-lookup"><span data-stu-id="e3819-174">The **ProcessRunCaller** and **ProcessRunner** workflows create invoices.</span></span> <span data-ttu-id="e3819-175">**ProcessRunCaller** kutsub töövoo **ProcessRunner**.</span><span class="sxs-lookup"><span data-stu-id="e3819-175">**ProcessRunCaller** calls **ProcessRunner**.</span></span> <span data-ttu-id="e3819-176">**ProcessRunner** on töövoog, mis tegelikult loob arveid.</span><span class="sxs-lookup"><span data-stu-id="e3819-176">**ProcessRunner** is the workflow that actually creates the invoices.</span></span> <span data-ttu-id="e3819-177">Töövoog läbib kõik lepinguread, mille jaoks tuleb arved luua, ja see loob neile ridadele arveid.</span><span class="sxs-lookup"><span data-stu-id="e3819-177">The workflow goes through all the contract lines that invoices must be created for, and creates invoices for those lines.</span></span> <span data-ttu-id="e3819-178">Selleks et määratleda lepingu read, mille jaoks arved tuleb luua, vaatab töö lepingurea arve käivitamise kuupäevi.</span><span class="sxs-lookup"><span data-stu-id="e3819-178">To determine the contract lines that invoices must be created for, the job looks at invoice run dates for the contract lines.</span></span> <span data-ttu-id="e3819-179">Kui ühele lepingule kuuluvatel lepinguridadel on sama arve käivitamise päev, kombineeritakse tehingud ühe arvega, millel on kaks arve rida.</span><span class="sxs-lookup"><span data-stu-id="e3819-179">If contract lines that belong to one contract have the same invoice run date, the transactions are combined into one invoice that has two invoice lines.</span></span> <span data-ttu-id="e3819-180">Kui arvete loomiseks pole kandeid, jätab töö arve loomise vahele.</span><span class="sxs-lookup"><span data-stu-id="e3819-180">If there are no transactions to create invoices for, the job skips creating an invoice.</span></span>

<span data-ttu-id="e3819-181">Kui **ProcessRunner** on töö lõpetanud, kutsub see töövoo **ProcessRunCaller**, annab lõppkellaaja ja sulgub.</span><span class="sxs-lookup"><span data-stu-id="e3819-181">After **ProcessRunner** has finished running, it calls **ProcessRunCaller**, provides the end time, and is closed.</span></span> <span data-ttu-id="e3819-182">**ProcessRunCaller** käivitab seejärel taimeri, mis kestab määratud lõppkellaajast 24 tundi.</span><span class="sxs-lookup"><span data-stu-id="e3819-182">**ProcessRunCaller** then starts a timer that runs for 24-hours from the specified end time.</span></span> <span data-ttu-id="e3819-183">Taimeri lõpus on **ProcessRunCaller** suletud.</span><span class="sxs-lookup"><span data-stu-id="e3819-183">At the end of the timer, **ProcessRunCaller** is closed.</span></span>

<span data-ttu-id="e3819-184">Arvete loomiseks kasutatav pakktöötluse töö on korduv töö.</span><span class="sxs-lookup"><span data-stu-id="e3819-184">The batch process job for creating invoices is a recurrent job.</span></span> <span data-ttu-id="e3819-185">Kui seda pakktöötlust käitatakse mitu korda, luuakse mitu tööeksemplari ja need põhjustavad tõrkeid.</span><span class="sxs-lookup"><span data-stu-id="e3819-185">If this batch process is run many times, multiple instances of the job are created and causes errors.</span></span> <span data-ttu-id="e3819-186">Seetõttu peaksite pakktöötluse käivitama ainult üks kord ja seejärel uuesti käivitama ainult siis, kui see lakkab töötamast.</span><span class="sxs-lookup"><span data-stu-id="e3819-186">Therefore, you should start the batch process only one time, and then restart only if it stops running.</span></span>

> [!NOTE]
> <span data-ttu-id="e3819-187">Project Operationsis pakett-arveldamine töötab ainult projekti lepinguridade jaoks, mis on arvegraafikute poolt konfigureeritud.</span><span class="sxs-lookup"><span data-stu-id="e3819-187">Batch invoicing in Project Operations only runs for project contract lines that are configured by invoice schedules.</span></span> <span data-ttu-id="e3819-188">Fikseeritud hinnaga arveldusmeetodiga lepingureal peavad olema seadistatud vahe-eesmärgid.</span><span class="sxs-lookup"><span data-stu-id="e3819-188">A contract line with a fixed price billing method must have milestones configured.</span></span> <span data-ttu-id="e3819-189">Aja- ja materjalikulu arveldusmeetodiga projekti lepingurea jaoks peab olema seadistatud kuupäevapõhine ajakava.</span><span class="sxs-lookup"><span data-stu-id="e3819-189">A project contract line with a time and material billing method will need a date-based invoice schedule set up.</span></span>


[!INCLUDE[footer-include](../../includes/footer-banner.md)]
